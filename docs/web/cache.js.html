

<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <title>cache.js - Backendjs Documentation</title>
    
    <meta name="description" content="A Node.js library to create Web backends with minimal dependencies." />
    
    
    

    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
    <script src="scripts/nav.js" defer></script>

    
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav >
    
    <input type="text" id="nav-search" placeholder="Search" />
    
    
    <h2><a href="index.html">Home</a></h2><h3>Tutorials</h3><ul><li><a href="tutorial-start.html">Getting Started</a><ul class='members'><li data-type='method' style='display: none;'><a href="tutorial-start.html#overview">Overview</a></li><li data-type='method' style='display: none;'><a href="tutorial-start.html#installing-backendjs">Installing backendjs</a></li><li data-type='method' style='display: none;'><a href="tutorial-start.html#creating-a-web-server">Creating a Web Server</a></li><li data-type='method' style='display: none;'><a href="tutorial-start.html#creating-a-module">Creating a module</a></li><li data-type='method' style='display: none;'><a href="tutorial-start.html#next-steps">Next steps</a></li></ul></li><li><a href="tutorial-modules.html">Modules</a><ul class='members'><li data-type='method' style='display: none;'><a href="tutorial-modules.html#npm-packages-as-modules">NPM packages as modules</a></li><li data-type='method' style='display: none;'><a href="tutorial-modules.html#message-passing">Message passing</a></li><li data-type='method' style='display: none;'><a href="tutorial-modules.html#default-methods">Default methods</a></li></ul></li><li><a href="tutorial-reference.html">Reference</a><ul class='members'><li data-type='method' style='display: none;'><a href="tutorial-reference.html#dependencies">Dependencies</a></li><li data-type='method' style='display: none;'><a href="tutorial-reference.html#configuration">Configuration</a></li><li data-type='method' style='display: none;'><a href="tutorial-reference.html#config-sources">Config sources</a></li><li data-type='method' style='display: none;'><a href="tutorial-reference.html#environment-variables">Environment variables</a></li><li data-type='method' style='display: none;'><a href="tutorial-reference.html#backend-library-development-mac-os-x-developers">Backend library development (Mac OS X, developers)</a></li></ul></li><li><a href="tutorial-config.html">Config parameters</a><ul class='members'><li data-type='method' style='display: none;'><a href="tutorial-config.html#api">api</a></li><li data-type='method' style='display: none;'><a href="tutorial-config.html#api.access">api.access</a></li><li data-type='method' style='display: none;'><a href="tutorial-config.html#api.acl">api.acl</a></li><li data-type='method' style='display: none;'><a href="tutorial-config.html#api.csrf">api.csrf</a></li><li data-type='method' style='display: none;'><a href="tutorial-config.html#api.passkey">api.passkey</a></li><li data-type='method' style='display: none;'><a href="tutorial-config.html#api.redirect">api.redirect</a></li><li data-type='method' style='display: none;'><a href="tutorial-config.html#api.routing">api.routing</a></li><li data-type='method' style='display: none;'><a href="tutorial-config.html#api.session">api.session</a></li><li data-type='method' style='display: none;'><a href="tutorial-config.html#api.signature">api.signature</a></li><li data-type='method' style='display: none;'><a href="tutorial-config.html#api.static">api.static</a></li><li data-type='method' style='display: none;'><a href="tutorial-config.html#api.users">api.users</a></li><li data-type='method' style='display: none;'><a href="tutorial-config.html#api.ws">api.ws</a></li><li data-type='method' style='display: none;'><a href="tutorial-config.html#app">app</a></li><li data-type='method' style='display: none;'><a href="tutorial-config.html#aws">aws</a></li><li data-type='method' style='display: none;'><a href="tutorial-config.html#cache">cache</a></li><li data-type='method' style='display: none;'><a href="tutorial-config.html#db">db</a></li><li data-type='method' style='display: none;'><a href="tutorial-config.html#events">events</a></li><li data-type='method' style='display: none;'><a href="tutorial-config.html#files">files</a></li><li data-type='method' style='display: none;'><a href="tutorial-config.html#ipc">ipc</a></li><li data-type='method' style='display: none;'><a href="tutorial-config.html#jobs">jobs</a></li><li data-type='method' style='display: none;'><a href="tutorial-config.html#logwatcher">logwatcher</a></li><li data-type='method' style='display: none;'><a href="tutorial-config.html#push">push</a></li><li data-type='method' style='display: none;'><a href="tutorial-config.html#queue">queue</a></li><li data-type='method' style='display: none;'><a href="tutorial-config.html#sendmail">sendmail</a></li><li data-type='method' style='display: none;'><a href="tutorial-config.html#sql">sql</a></li><li data-type='method' style='display: none;'><a href="tutorial-config.html#stats">stats</a></li></ul></li><li><a href="tutorial-bkjs.html">The bkjs tool</a><ul class='members'><li data-type='method' style='display: none;'><a href="tutorial-bkjs.html#environment">Environment</a></li><li data-type='method' style='display: none;'><a href="tutorial-bkjs.html#functions">Functions</a></li><li data-type='method' style='display: none;'><a href="tutorial-bkjs.html#extending-bkjs-tool">Extending bkjs tool</a></li></ul></li></ul><h3>Modules</h3><ul><li><a href="module-api.html">api</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-api.html#.checkProxy">checkProxy</a></li><li data-type='method' style='display: none;'><a href="module-api.html#.checkRateLimits">checkRateLimits</a></li><li data-type='method' style='display: none;'><a href="module-api.html#.checkRequestPlaceholders">checkRequestPlaceholders</a></li><li data-type='method' style='display: none;'><a href="module-api.html#.cleanupHeaders">cleanupHeaders</a></li><li data-type='method' style='display: none;'><a href="module-api.html#.cleanupResult">cleanupResult</a></li><li data-type='method' style='display: none;'><a href="module-api.html#.createWebServer">createWebServer</a></li><li data-type='method' style='display: none;'><a href="module-api.html#.getResultPage">getResultPage</a></li><li data-type='method' style='display: none;'><a href="module-api.html#.handleBody">handleBody</a></li><li data-type='method' style='display: none;'><a href="module-api.html#.handleCleanup">handleCleanup</a></li><li data-type='method' style='display: none;'><a href="module-api.html#.handleMetrics">handleMetrics</a></li><li data-type='method' style='display: none;'><a href="module-api.html#.handleMultipart">handleMultipart</a></li><li data-type='method' style='display: none;'><a href="module-api.html#.init">init</a></li><li data-type='method' style='display: none;'><a href="module-api.html#.prepareOptions">prepareOptions</a></li><li data-type='method' style='display: none;'><a href="module-api.html#.prepareRequest">prepareRequest</a></li><li data-type='method' style='display: none;'><a href="module-api.html#.registerPreHeaders">registerPreHeaders</a></li><li data-type='method' style='display: none;'><a href="module-api.html#.registerRateLimits">registerRateLimits</a></li><li data-type='method' style='display: none;'><a href="module-api.html#.replacePath">replacePath</a></li><li data-type='method' style='display: none;'><a href="module-api.html#.sendFile">sendFile</a></li><li data-type='method' style='display: none;'><a href="module-api.html#.sendFormatted">sendFormatted</a></li><li data-type='method' style='display: none;'><a href="module-api.html#.sendJSON">sendJSON</a></li><li data-type='method' style='display: none;'><a href="module-api.html#.sendReply">sendReply</a></li><li data-type='method' style='display: none;'><a href="module-api.html#.sendStatus">sendStatus</a></li><li data-type='method' style='display: none;'><a href="module-api.html#.shutdown">shutdown</a></li><li data-type='method' style='display: none;'><a href="module-api.html#.startMetrics">startMetrics</a></li><li data-type='method' style='display: none;'><a href="module-api.html#.toParams">toParams</a></li></ul></li><li><a href="module-api_access.html">api/access</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-api_access.html#.allow">allow</a></li><li data-type='method' style='display: none;'><a href="module-api_access.html#.authenticate">authenticate</a></li><li data-type='method' style='display: none;'><a href="module-api_access.html#.authorize">authorize</a></li><li data-type='method' style='display: none;'><a href="module-api_access.html#.configureMiddleware">configureMiddleware</a></li><li data-type='method' style='display: none;'><a href="module-api_access.html#.middleware">middleware</a></li><li data-type='method' style='display: none;'><a href="module-api_access.html#.setUser">setUser</a></li></ul></li><li><a href="module-api_acl.html">api/acl</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-api_acl.html#.isAllowed">isAllowed</a></li><li data-type='method' style='display: none;'><a href="module-api_acl.html#.isAnonymous">isAnonymous</a></li><li data-type='method' style='display: none;'><a href="module-api_acl.html#.isAuthenticated">isAuthenticated</a></li><li data-type='method' style='display: none;'><a href="module-api_acl.html#.isDenied">isDenied</a></li><li data-type='method' style='display: none;'><a href="module-api_acl.html#.isMatched">isMatched</a></li><li data-type='method' style='display: none;'><a href="module-api_acl.html#.isPublic">isPublic</a></li><li data-type='method' style='display: none;'><a href="module-api_acl.html#.reset">reset</a></li></ul></li><li><a href="module-api_csrf.html">api/csrf</a></li><li><a href="module-api_hooks.html">api/hooks</a></li><li><a href="module-api_passkey.html">api/passkey</a></li><li><a href="module-api_redirect.html">api/redirect</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-api_redirect.html#.check">check</a></li></ul></li><li><a href="module-api_routing.html">api/routing</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-api_routing.html#.check">check</a></li></ul></li><li><a href="module-api_session.html">api/session</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-api_session.html#.check">check</a></li><li data-type='method' style='display: none;'><a href="module-api_session.html#.clear">clear</a></li><li data-type='method' style='display: none;'><a href="module-api_session.html#.create">create</a></li><li data-type='method' style='display: none;'><a href="module-api_session.html#.getCookie">getCookie</a></li><li data-type='method' style='display: none;'><a href="module-api_session.html#.makeCookie">makeCookie</a></li><li data-type='method' style='display: none;'><a href="module-api_session.html#.save">save</a></li><li data-type='method' style='display: none;'><a href="module-api_session.html#.setCookie">setCookie</a></li><li data-type='method' style='display: none;'><a href="module-api_session.html#.setup">setup</a></li></ul></li><li><a href="module-api_signature.html">api/signature</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-api_signature.html#.create">create</a></li><li data-type='method' style='display: none;'><a href="module-api_signature.html#.fromRequest">fromRequest</a></li><li data-type='method' style='display: none;'><a href="module-api_signature.html#.get">get</a></li><li data-type='method' style='display: none;'><a href="module-api_signature.html#.verify">verify</a></li></ul></li><li><a href="module-api_static.html">api/static</a></li><li><a href="module-api_users.html">api/users</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-api_users.html#.aadd">aadd</a></li><li data-type='method' style='display: none;'><a href="module-api_users.html#.add">add</a></li><li data-type='method' style='display: none;'><a href="module-api_users.html#.adel">adel</a></li><li data-type='method' style='display: none;'><a href="module-api_users.html#.aget">aget</a></li><li data-type='method' style='display: none;'><a href="module-api_users.html#.aupdate">aupdate</a></li><li data-type='method' style='display: none;'><a href="module-api_users.html#.auth">auth</a></li><li data-type='method' style='display: none;'><a href="module-api_users.html#.del">del</a></li><li data-type='method' style='display: none;'><a href="module-api_users.html#.get">get</a></li><li data-type='method' style='display: none;'><a href="module-api_users.html#.login">login</a></li><li data-type='method' style='display: none;'><a href="module-api_users.html#.logout">logout</a></li><li data-type='method' style='display: none;'><a href="module-api_users.html#.update">update</a></li></ul></li><li><a href="module-api_ws.html">api/ws</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-api_ws.html#.broadcast">broadcast</a></li><li data-type='method' style='display: none;'><a href="module-api_ws.html#.notify">notify</a></li></ul></li><li><a href="module-app.html">app</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-app.html#.addModule">addModule</a></li><li data-type='method' style='display: none;'><a href="module-app.html#.ainit">ainit</a></li><li data-type='method' style='display: none;'><a href="module-app.html#.arunMethods">arunMethods</a></li><li data-type='method' style='display: none;'><a href="module-app.html#.checkConfig">checkConfig</a></li><li data-type='method' style='display: none;'><a href="module-app.html#.createRepl">createRepl</a></li><li data-type='method' style='display: none;'><a href="module-app.html#.describeArgs">describeArgs</a></li><li data-type='method' style='display: none;'><a href="module-app.html#.init">init</a></li><li data-type='method' style='display: none;'><a href="module-app.html#.isOk">isOk</a></li><li data-type='method' style='display: none;'><a href="module-app.html#.killBackend">killBackend</a></li><li data-type='method' style='display: none;'><a href="module-app.html#.loadModules">loadModules</a></li><li data-type='method' style='display: none;'><a href="module-app.html#.loadPackages">loadPackages</a></li><li data-type='method' style='display: none;'><a href="module-app.html#.mime">mime</a></li><li data-type='method' style='display: none;'><a href="module-app.html#.origin">origin</a></li><li data-type='method' style='display: none;'><a href="module-app.html#.parseArgs">parseArgs</a></li><li data-type='method' style='display: none;'><a href="module-app.html#.parseConfig">parseConfig</a></li><li data-type='method' style='display: none;'><a href="module-app.html#.processArg">processArg</a></li><li data-type='method' style='display: none;'><a href="module-app.html#.processArgs">processArgs</a></li><li data-type='method' style='display: none;'><a href="module-app.html#.processEnvArgs">processEnvArgs</a></li><li data-type='method' style='display: none;'><a href="module-app.html#.runMethod">runMethod</a></li><li data-type='method' style='display: none;'><a href="module-app.html#.runMethods">runMethods</a></li><li data-type='method' style='display: none;'><a href="module-app.html#.setHome">setHome</a></li><li data-type='method' style='display: none;'><a href="module-app.html#.setHost">setHost</a></li><li data-type='method' style='display: none;'><a href="module-app.html#.setLogInspect">setLogInspect</a></li><li data-type='method' style='display: none;'><a href="module-app.html#.setRole">setRole</a></li><li data-type='method' style='display: none;'><a href="module-app.html#.sortModules">sortModules</a></li><li data-type='method' style='display: none;'><a href="module-app.html#.start">start</a></li><li data-type='method' style='display: none;'><a href="module-app.html#.startRepl">startRepl</a></li><li data-type='method' style='display: none;'><a href="module-app.html#.stop">stop</a></li><li data-type='method' style='display: none;'><a href="module-app.html#.watchTmp">watchTmp</a></li></ul></li><li><a href="module-aws.html">aws</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-aws.html#.batchGetSecrets">batchGetSecrets</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.configureJob">configureJob</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.cwGetMetricData">cwGetMetricData</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.cwListMetrics">cwListMetrics</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.cwPutLogEvents">cwPutLogEvents</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.cwPutMetricAlarm">cwPutMetricAlarm</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.cwPutMetricData">cwPutMetricData</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.cwlFilterLogEvents">cwlFilterLogEvents</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.ddbBatchGetItem">ddbBatchGetItem</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.ddbBatchWriteItem">ddbBatchWriteItem</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.ddbCreateTable">ddbCreateTable</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.ddbDeleteItem">ddbDeleteItem</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.ddbDeleteTable">ddbDeleteTable</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.ddbDescribeTable">ddbDescribeTable</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.ddbDescribeTimeToLive">ddbDescribeTimeToLive</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.ddbGetItem">ddbGetItem</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.ddbListTables">ddbListTables</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.ddbPutItem">ddbPutItem</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.ddbQueryTable">ddbQueryTable</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.ddbScanTable">ddbScanTable</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.ddbTransactWriteItems">ddbTransactWriteItems</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.ddbUpdateItem">ddbUpdateItem</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.ddbUpdateTable">ddbUpdateTable</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.ddbUpdateTimeToLive">ddbUpdateTimeToLive</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.ddbWaitForTable">ddbWaitForTable</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.detectLabels">detectLabels</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.ec2AssociateAddress">ec2AssociateAddress</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.ec2AttachNetworkInterface">ec2AttachNetworkInterface</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.ec2CreateImage">ec2CreateImage</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.ec2CreateTags">ec2CreateTags</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.ec2DeregisterImage">ec2DeregisterImage</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.ec2DescribeInstances">ec2DescribeInstances</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.ec2DescribeSecurityGroups">ec2DescribeSecurityGroups</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.ec2DescribeSubnets">ec2DescribeSubnets</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.ec2RunInstances">ec2RunInstances</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.ec2WaitForInstance">ec2WaitForInstance</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.ecsDescribeTasks">ecsDescribeTasks</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.ecsPrepareTask">ecsPrepareTask</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.ecsRunTask">ecsRunTask</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.ecsTaskProtection">ecsTaskProtection</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.elb2DeregisterInstances">elb2DeregisterInstances</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.elb2RegisterInstances">elb2RegisterInstances</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.fromDynamoDB">fromDynamoDB</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.getInstanceCredentials">getInstanceCredentials</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.getInstanceDetails">getInstanceDetails</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.getInstanceInfo">getInstanceInfo</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.getInstanceMeta">getInstanceMeta</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.getInstanceMetaToken">getInstanceMetaToken</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.getSecretValue">getSecretValue</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.getTaskDetails">getTaskDetails</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.listCertificates">listCertificates</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.parseXMLResponse">parseXMLResponse</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.queryACM">queryACM</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.queryAS">queryAS</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.queryAWS">queryAWS</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.queryCFN">queryCFN</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.queryCW">queryCW</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.queryCWL">queryCWL</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.queryComprehend">queryComprehend</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.queryDDB">queryDDB</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.queryEC2">queryEC2</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.queryECR">queryECR</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.queryECS">queryECS</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.queryELB2">queryELB2</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.queryElastiCache">queryElastiCache</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.queryEndpoint">queryEndpoint</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.queryEvents">queryEvents</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.queryIAM">queryIAM</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.queryRekognition">queryRekognition</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.queryRoute53">queryRoute53</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.queryRoute53Domains">queryRoute53Domains</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.queryS3">queryS3</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.querySES">querySES</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.querySNS">querySNS</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.querySQS">querySQS</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.querySSM">querySSM</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.querySTS">querySTS</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.querySecrets">querySecrets</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.queryService">queryService</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.querySign">querySign</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.queryTranscribe">queryTranscribe</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.readConfig">readConfig</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.readCredentials">readCredentials</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.route53Change">route53Change</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.route53Create">route53Create</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.route53Get">route53Get</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.route53List">route53List</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.s3CopyFile">s3CopyFile</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.s3GetFile">s3GetFile</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.s3List">s3List</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.s3ParseUrl">s3ParseUrl</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.s3Proxy">s3Proxy</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.s3PutFile">s3PutFile</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.sesSendEmail">sesSendEmail</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.sesSendRawEmail">sesSendRawEmail</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.sesSendRawEmail2">sesSendRawEmail2</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.signS3">signS3</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.snsConfirmSubscription">snsConfirmSubscription</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.snsCreatePlatformEndpoint">snsCreatePlatformEndpoint</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.snsCreateTopic">snsCreateTopic</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.snsDeleteEndpoint">snsDeleteEndpoint</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.snsDeleteTopic">snsDeleteTopic</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.snsListTopics">snsListTopics</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.snsPublish">snsPublish</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.snsSetEndpointAttributes">snsSetEndpointAttributes</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.snsSetSubscriptionAttributes">snsSetSubscriptionAttributes</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.snsSetTopicAttributes">snsSetTopicAttributes</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.snsSubscribe">snsSubscribe</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.snsUnsubscribe">snsUnsubscribe</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.sqsReceiveMessage">sqsReceiveMessage</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.sqsSendMessage">sqsSendMessage</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.ssmGetParametersByPath">ssmGetParametersByPath</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.ssmSendCommand">ssmSendCommand</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.ssmWaitForCommand">ssmWaitForCommand</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.stsAssumeRole">stsAssumeRole</a></li><li data-type='method' style='display: none;'><a href="module-aws.html#.toDynamoDB">toDynamoDB</a></li></ul></li><li><a href="module-cache.html">cache</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-cache.html#.aclear">aclear</a></li><li data-type='method' style='display: none;'><a href="module-cache.html#.adel">adel</a></li><li data-type='method' style='display: none;'><a href="module-cache.html#.aget">aget</a></li><li data-type='method' style='display: none;'><a href="module-cache.html#.aincr">aincr</a></li><li data-type='method' style='display: none;'><a href="module-cache.html#.alock">alock</a></li><li data-type='method' style='display: none;'><a href="module-cache.html#.aput">aput</a></li><li data-type='method' style='display: none;'><a href="module-cache.html#.astats">astats</a></li><li data-type='method' style='display: none;'><a href="module-cache.html#.aunlock">aunlock</a></li><li data-type='method' style='display: none;'><a href="module-cache.html#.checkConfig">checkConfig</a></li><li data-type='method' style='display: none;'><a href="module-cache.html#.checkLimiter">checkLimiter</a></li><li data-type='method' style='display: none;'><a href="module-cache.html#.clear">clear</a></li><li data-type='method' style='display: none;'><a href="module-cache.html#.createClient">createClient</a></li><li data-type='method' style='display: none;'><a href="module-cache.html#.del">del</a></li><li data-type='method' style='display: none;'><a href="module-cache.html#.get">get</a></li><li data-type='method' style='display: none;'><a href="module-cache.html#.getClient">getClient</a></li><li data-type='method' style='display: none;'><a href="module-cache.html#.incr">incr</a></li><li data-type='method' style='display: none;'><a href="module-cache.html#.initClients">initClients</a></li><li data-type='method' style='display: none;'><a href="module-cache.html#.limiter">limiter</a></li><li data-type='method' style='display: none;'><a href="module-cache.html#.localLimiter">localLimiter</a></li><li data-type='method' style='display: none;'><a href="module-cache.html#.lock">lock</a></li><li data-type='method' style='display: none;'><a href="module-cache.html#.put">put</a></li><li data-type='method' style='display: none;'><a href="module-cache.html#.shutdown">shutdown</a></li><li data-type='method' style='display: none;'><a href="module-cache.html#.stats">stats</a></li><li data-type='method' style='display: none;'><a href="module-cache.html#.unlock">unlock</a></li></ul></li><li><a href="module-db.html">db</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-db.html#.aadd">aadd</a></li><li data-type='method' style='display: none;'><a href="module-db.html#.abatch">abatch</a></li><li data-type='method' style='display: none;'><a href="module-db.html#.abulk">abulk</a></li><li data-type='method' style='display: none;'><a href="module-db.html#.acopy">acopy</a></li><li data-type='method' style='display: none;'><a href="module-db.html#.acreate">acreate</a></li><li data-type='method' style='display: none;'><a href="module-db.html#.add">add</a></li><li data-type='method' style='display: none;'><a href="module-db.html#.adel">adel</a></li><li data-type='method' style='display: none;'><a href="module-db.html#.adelAll">adelAll</a></li><li data-type='method' style='display: none;'><a href="module-db.html#.adrop">adrop</a></li><li data-type='method' style='display: none;'><a href="module-db.html#.aget">aget</a></li><li data-type='method' style='display: none;'><a href="module-db.html#.aincr">aincr</a></li><li data-type='method' style='display: none;'><a href="module-db.html#.alist">alist</a></li><li data-type='method' style='display: none;'><a href="module-db.html#.applyPoolOptions">applyPoolOptions</a></li><li data-type='method' style='display: none;'><a href="module-db.html#.aput">aput</a></li><li data-type='method' style='display: none;'><a href="module-db.html#.aquery">aquery</a></li><li data-type='method' style='display: none;'><a href="module-db.html#.ascan">ascan</a></li><li data-type='method' style='display: none;'><a href="module-db.html#.asearch">asearch</a></li><li data-type='method' style='display: none;'><a href="module-db.html#.aselect">aselect</a></li><li data-type='method' style='display: none;'><a href="module-db.html#.asql">asql</a></li><li data-type='method' style='display: none;'><a href="module-db.html#.atransaction">atransaction</a></li><li data-type='method' style='display: none;'><a href="module-db.html#.aupdate">aupdate</a></li><li data-type='method' style='display: none;'><a href="module-db.html#.aupdateAll">aupdateAll</a></li><li data-type='method' style='display: none;'><a href="module-db.html#.aupgrade">aupgrade</a></li><li data-type='method' style='display: none;'><a href="module-db.html#.batch">batch</a></li><li data-type='method' style='display: none;'><a href="module-db.html#.bulk">bulk</a></li><li data-type='method' style='display: none;'><a href="module-db.html#.cacheColumns">cacheColumns</a></li><li data-type='method' style='display: none;'><a href="module-db.html#.checkCapacity">checkCapacity</a></li><li data-type='method' style='display: none;'><a href="module-db.html#.configTypes">configTypes</a></li><li data-type='method' style='display: none;'><a href="module-db.html#.configureCollectStats">configureCollectStats</a></li><li data-type='method' style='display: none;'><a href="module-db.html#.convertError">convertError</a></li><li data-type='method' style='display: none;'><a href="module-db.html#.convertRows">convertRows</a></li><li data-type='method' style='display: none;'><a href="module-db.html#.copy">copy</a></li><li data-type='method' style='display: none;'><a href="module-db.html#.create">create</a></li><li data-type='method' style='display: none;'><a href="module-db.html#.createTables">createTables</a></li><li data-type='method' style='display: none;'><a href="module-db.html#.del">del</a></li><li data-type='method' style='display: none;'><a href="module-db.html#.delAll">delAll</a></li><li data-type='method' style='display: none;'><a href="module-db.html#.describeTables">describeTables</a></li><li data-type='method' style='display: none;'><a href="module-db.html#.drop">drop</a></li><li data-type='method' style='display: none;'><a href="module-db.html#.existsPool">existsPool</a></li><li data-type='method' style='display: none;'><a href="module-db.html#.get">get</a></li><li data-type='method' style='display: none;'><a href="module-db.html#.getCached">getCached</a></li><li data-type='method' style='display: none;'><a href="module-db.html#.getCapacity">getCapacity</a></li><li data-type='method' style='display: none;'><a href="module-db.html#.getConfig">getConfig</a></li><li data-type='method' style='display: none;'><a href="module-db.html#.getIndexes">getIndexes</a></li><li data-type='method' style='display: none;'><a href="module-db.html#.getKeys">getKeys</a></li><li data-type='method' style='display: none;'><a href="module-db.html#.getPool">getPool</a></li><li data-type='method' style='display: none;'><a href="module-db.html#.getPoolTables">getPoolTables</a></li><li data-type='method' style='display: none;'><a href="module-db.html#.getPools">getPools</a></li><li data-type='method' style='display: none;'><a href="module-db.html#.getProcessRows">getProcessRows</a></li><li data-type='method' style='display: none;'><a href="module-db.html#.getQueryForKeys">getQueryForKeys</a></li><li data-type='method' style='display: none;'><a href="module-db.html#.incr">incr</a></li><li data-type='method' style='display: none;'><a href="module-db.html#.init">init</a></li><li data-type='method' style='display: none;'><a href="module-db.html#.initColumns">initColumns</a></li><li data-type='method' style='display: none;'><a href="module-db.html#.initConfig">initConfig</a></li><li data-type='method' style='display: none;'><a href="module-db.html#.initTables">initTables</a></li><li data-type='method' style='display: none;'><a href="module-db.html#.list">list</a></li><li data-type='method' style='display: none;'><a href="module-db.html#.parseNameOp">parseNameOp</a></li><li data-type='method' style='display: none;'><a href="module-db.html#.prepare">prepare</a></li><li data-type='method' style='display: none;'><a href="module-db.html#.prepareColumn">prepareColumn</a></li><li data-type='method' style='display: none;'><a href="module-db.html#.prepareQuery">prepareQuery</a></li><li data-type='method' style='display: none;'><a href="module-db.html#.prepareValue">prepareValue</a></li><li data-type='method' style='display: none;'><a href="module-db.html#.put">put</a></li><li data-type='method' style='display: none;'><a href="module-db.html#.query">query</a></li><li data-type='method' style='display: none;'><a href="module-db.html#.queryProcessSync">queryProcessSync</a></li><li data-type='method' style='display: none;'><a href="module-db.html#.refreshColumns">refreshColumns</a></li><li data-type='method' style='display: none;'><a href="module-db.html#.runProcessRows">runProcessRows</a></li><li data-type='method' style='display: none;'><a href="module-db.html#.scan">scan</a></li><li data-type='method' style='display: none;'><a href="module-db.html#.search">search</a></li><li data-type='method' style='display: none;'><a href="module-db.html#.select">select</a></li><li data-type='method' style='display: none;'><a href="module-db.html#.setConfig">setConfig</a></li><li data-type='method' style='display: none;'><a href="module-db.html#.setProcessColumns">setProcessColumns</a></li><li data-type='method' style='display: none;'><a href="module-db.html#.setProcessRow">setProcessRow</a></li><li data-type='method' style='display: none;'><a href="module-db.html#.sql">sql</a></li><li data-type='method' style='display: none;'><a href="module-db.html#.transaction">transaction</a></li><li data-type='method' style='display: none;'><a href="module-db.html#.update">update</a></li><li data-type='method' style='display: none;'><a href="module-db.html#.updateAll">updateAll</a></li><li data-type='method' style='display: none;'><a href="module-db.html#.upgrade">upgrade</a></li></ul></li><li><a href="module-events.html">events</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-events.html#.putEvent">putEvent</a></li></ul></li><li><a href="module-files.html">files</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-files.html#.copy">copy</a></li><li data-type='method' style='display: none;'><a href="module-files.html#.del">del</a></li><li data-type='method' style='display: none;'><a href="module-files.html#.detect">detect</a></li><li data-type='method' style='display: none;'><a href="module-files.html#.detectAndStore">detectAndStore</a></li><li data-type='method' style='display: none;'><a href="module-files.html#.list">list</a></li><li data-type='method' style='display: none;'><a href="module-files.html#.read">read</a></li><li data-type='method' style='display: none;'><a href="module-files.html#.send">send</a></li><li data-type='method' style='display: none;'><a href="module-files.html#.store">store</a></li><li data-type='method' style='display: none;'><a href="module-files.html#.upload">upload</a></li><li data-type='method' style='display: none;'><a href="module-files.html#.url">url</a></li></ul></li><li><a href="module-files_image.html">files/image</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-files_image.html#.composite">composite</a></li><li data-type='method' style='display: none;'><a href="module-files_image.html#.convert">convert</a></li><li data-type='method' style='display: none;'><a href="module-files_image.html#.create">create</a></li><li data-type='method' style='display: none;'><a href="module-files_image.html#.gravityRegion">gravityRegion</a></li><li data-type='method' style='display: none;'><a href="module-files_image.html#.stats">stats</a></li></ul></li><li><a href="module-ipc.html">ipc</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-ipc.html#.broadcast">broadcast</a></li><li data-type='method' style='display: none;'><a href="module-ipc.html#.emitMsg">emitMsg</a></li><li data-type='method' style='display: none;'><a href="module-ipc.html#.initServer">initServer</a></li><li data-type='method' style='display: none;'><a href="module-ipc.html#.initWorker">initWorker</a></li><li data-type='method' style='display: none;'><a href="module-ipc.html#.newMsg">newMsg</a></li><li data-type='method' style='display: none;'><a href="module-ipc.html#.sendMsg">sendMsg</a></li></ul></li><li><a href="module-jobs.html">jobs</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-jobs.html#.cancelJob">cancelJob</a></li><li data-type='method' style='display: none;'><a href="module-jobs.html#.isCancelled">isCancelled</a></li><li data-type='method' style='display: none;'><a href="module-jobs.html#.loadCronjobs">loadCronjobs</a></li><li data-type='method' style='display: none;'><a href="module-jobs.html#.markCancelled">markCancelled</a></li><li data-type='method' style='display: none;'><a href="module-jobs.html#.scheduleCronjob">scheduleCronjob</a></li><li data-type='method' style='display: none;'><a href="module-jobs.html#.scheduleCronjobs">scheduleCronjobs</a></li><li data-type='method' style='display: none;'><a href="module-jobs.html#.submitJob">submitJob</a></li></ul></li><li><a href="module-lib.html">lib</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-lib.html#.AhoCorasick">AhoCorasick</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.__">__</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.aexecProcess">aexecProcess</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.afetch">afetch</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.afindProcess">afindProcess</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.areadFile">areadFile</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.areadFile">areadFile</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.arrayEqual">arrayEqual</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.arrayFlatten">arrayFlatten</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.arrayLength">arrayLength</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.arrayRemove">arrayRemove</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.arrayUnique">arrayUnique</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.aspawnProcess">aspawnProcess</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.autoType">autoType</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.base64ToJson">base64ToJson</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.call">call</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.cidrRange">cidrRange</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.clock">clock</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.clone">clone</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.configParse">configParse</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.copyFile">copyFile</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.cpuStats">cpuStats</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.daysInMonth">daysInMonth</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.decodeURIComponent">decodeURIComponent</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.decrypt">decrypt</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.deferCallback">deferCallback</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.deferInterval">deferInterval</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.deferShutdown">deferShutdown</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.doWhilst">doWhilst</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.domainName">domainName</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.dropPrivileges">dropPrivileges</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.encodeURIComponent">encodeURIComponent</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.encrypt">encrypt</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.entityToText">entityToText</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.escapeUnicode">escapeUnicode</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.everyParallel">everyParallel</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.everySeries">everySeries</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.execProcess">execProcess</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.extend">extend</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.fetch">fetch</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.findFile">findFile</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.findFileFilter">findFileFilter</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.findFileSync">findFileSync</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.findProcess">findProcess</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.findWords">findWords</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.flatten">flatten</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.forEach">forEach</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.forEachItem">forEachItem</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.forEachLimit">forEachLimit</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.forEachLine">forEachLine</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.forEachLineSync">forEachLineSync</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.forEachSeries">forEachSeries</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.forEvery">forEvery</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.forEveryLimit">forEveryLimit</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.forEverySeries">forEverySeries</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.fromBase32">fromBase32</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.fromBase62">fromBase62</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.fromBase64url">fromBase64url</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.gcStats">gcStats</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.getArg">getArg</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.getArgInt">getArgInt</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.getHashid">getHashid</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.getWorkers">getWorkers</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.getuid">getuid</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.hash">hash</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.heapStats">heapStats</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.inCidr">inCidr</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.inspect">inspect</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.int2ip">int2ip</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.ip2int">ip2int</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.isArg">isArg</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.isArray">isArray</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.isDST">isDST</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.isDate">isDate</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.isEmpty">isEmpty</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.isFlag">isFlag</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.isFunc">isFunc</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.isMatched">isMatched</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.isNumber">isNumber</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.isNumeric">isNumeric</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.isObject">isObject</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.isPositive">isPositive</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.isPrefix">isPrefix</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.isSimilar">isSimilar</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.isString">isString</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.isTimeRange">isTimeRange</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.isTrue">isTrue</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.isUnicode">isUnicode</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.isUuid">isUuid</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.isValidBool">isValidBool</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.isValidNum">isValidNum</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.isValidPositive">isValidPositive</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.isValidVersion">isValidVersion</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.isWord">isWord</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.jsonFormat">jsonFormat</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.jsonFormatPreset">jsonFormatPreset</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.jsonParse">jsonParse</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.jsonToBase64">jsonToBase64</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.killWorkers">killWorkers</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.loadLocale">loadLocale</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.localEpoch">localEpoch</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.log">log</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.lzCompress">lzCompress</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.lzDecompress">lzDecompress</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.makePath">makePath</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.makePathSync">makePathSync</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.matchAllRegexp">matchAllRegexp</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.matchRegexp">matchRegexp</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.memoryStats">memoryStats</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.moveFile">moveFile</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.murmurHash3">murmurHash3</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.networkInterfaces">networkInterfaces</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.networkStats">networkStats</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.newError">newError</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.normalize">normalize</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.notifyWorkers">notifyWorkers</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.now">now</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.objGet">objGet</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.objIncr">objIncr</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.objKeys">objKeys</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.objMult">objMult</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.objSet">objSet</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.objSize">objSize</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.parallel">parallel</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.parseCookies">parseCookies</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.parseTime">parseTime</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.phraseSplit">phraseSplit</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.random">random</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.randomBytes">randomBytes</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.randomFloat">randomFloat</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.randomInt">randomInt</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.randomNum">randomNum</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.randomShort">randomShort</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.randomUInt">randomUInt</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.randomUShort">randomUShort</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.readFile">readFile</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.readFileSync">readFileSync</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.replaceRegexp">replaceRegexp</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.runCallback">runCallback</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.series">series</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.sfuuid">sfuuid</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.shuffle">shuffle</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.sign">sign</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.sleep">sleep</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.slug">slug</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.sortByVersion">sortByVersion</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.spawnProcess">spawnProcess</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.spawnSeries">spawnSeries</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.split">split</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.sprintf">sprintf</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.statSync">statSync</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.strftimeMap">strftimeMap</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.stringify">stringify</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.suuid">suuid</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.testRegexp">testRegexp</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.testRegexpObj">testRegexpObj</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.textToEntity">textToEntity</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.textToXml">textToXml</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.timingSafeEqual">timingSafeEqual</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.toBase32">toBase32</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.toBase62">toBase62</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.toBase64url">toBase64url</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.toBool">toBool</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.toCamel">toCamel</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.toDate">toDate</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.toDigits">toDigits</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.toDuration">toDuration</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.toEmail">toEmail</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.toFlags">toFlags</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.toFormat">toFormat</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.toMap">toMap</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.toMilliseconds">toMilliseconds</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.toMtime">toMtime</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.toNumber">toNumber</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.toParams">toParams</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.toPrice">toPrice</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.toRFC3339">toRFC3339</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.toRegexp">toRegexp</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.toRegexpMap">toRegexpMap</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.toRegexpObj">toRegexpObj</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.toSize">toSize</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.toSkip32">toSkip32</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.toString">toString</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.toTemplate">toTemplate</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.toTitle">toTitle</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.toUncamel">toUncamel</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.toUrl">toUrl</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.toValue">toValue</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.toVersion">toVersion</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.totp">totp</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.traceError">traceError</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.trim">trim</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.tryCall">tryCall</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.tryCatch">tryCatch</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.tryLater">tryLater</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.tryRequire">tryRequire</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.typeName">typeName</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.tzName">tzName</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.unescape">unescape</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.unicode2Ascii">unicode2Ascii</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.unlink">unlink</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.unlinkPath">unlinkPath</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.unlinkPathSync">unlinkPathSync</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.unlinkSync">unlinkSync</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.uuid">uuid</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.watchFiles">watchFiles</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.weekDate">weekDate</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.weekOfYear">weekOfYear</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.whilst">whilst</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.wrap">wrap</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.writeLines">writeLines</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.xmlParse">xmlParse</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#.zeropad">zeropad</a></li><li data-type='method' style='display: none;'><a href="module-lib.html#~onDeferCallback">onDeferCallback</a></li></ul><ul class='typedefs'><li data-type='typedef' style='display: none;'><a href="module-lib.html#.ParamsOptions">ParamsOptions</a></li></ul></li><li><a href="module-lib_JWT.html">lib/JWT</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-lib_JWT.html#.importPrivateKey">importPrivateKey</a></li><li data-type='method' style='display: none;'><a href="module-lib_JWT.html#.importPublicKey">importPublicKey</a></li><li data-type='method' style='display: none;'><a href="module-lib_JWT.html#.sign">sign</a></li><li data-type='method' style='display: none;'><a href="module-lib_JWT.html#.verify">verify</a></li></ul></li><li><a href="module-lib_respawn.html">lib/respawn</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-lib_respawn.html#.check">check</a></li></ul></li><li><a href="module-logger.html">logger</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-logger.html#.debug">debug</a></li><li data-type='method' style='display: none;'><a href="module-logger.html#.dev">dev</a></li><li data-type='method' style='display: none;'><a href="module-logger.html#.error">error</a></li><li data-type='method' style='display: none;'><a href="module-logger.html#.info">info</a></li><li data-type='method' style='display: none;'><a href="module-logger.html#.log">log</a></li><li data-type='method' style='display: none;'><a href="module-logger.html#.logger">logger</a></li><li data-type='method' style='display: none;'><a href="module-logger.html#.none">none</a></li><li data-type='method' style='display: none;'><a href="module-logger.html#.prefix">prefix</a></li><li data-type='method' style='display: none;'><a href="module-logger.html#.registerLevel">registerLevel</a></li><li data-type='method' style='display: none;'><a href="module-logger.html#.setDebugFilter">setDebugFilter</a></li><li data-type='method' style='display: none;'><a href="module-logger.html#.setFile">setFile</a></li><li data-type='method' style='display: none;'><a href="module-logger.html#.setLevel">setLevel</a></li><li data-type='method' style='display: none;'><a href="module-logger.html#.setOptions">setOptions</a></li><li data-type='method' style='display: none;'><a href="module-logger.html#.setSyslog">setSyslog</a></li><li data-type='method' style='display: none;'><a href="module-logger.html#.trace">trace</a></li><li data-type='method' style='display: none;'><a href="module-logger.html#.warn">warn</a></li></ul></li><li><a href="module-logwatcher.html">logwatcher</a></li><li><a href="module-metrics.html">metrics</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-metrics.html#.incr">incr</a></li><li data-type='method' style='display: none;'><a href="module-metrics.html#.take">take</a></li><li data-type='method' style='display: none;'><a href="module-metrics.html#.toJSON">toJSON</a></li></ul></li><li><a href="module-modules.html">modules</a></li><li><a href="module-push.html">push</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-push.html#.configureModule">configureModule</a></li><li data-type='method' style='display: none;'><a href="module-push.html#.init">init</a></li><li data-type='method' style='display: none;'><a href="module-push.html#.parseDevice">parseDevice</a></li><li data-type='method' style='display: none;'><a href="module-push.html#.send">send</a></li><li data-type='method' style='display: none;'><a href="module-push.html#.shutdown">shutdown</a></li></ul></li><li><a href="module-queue.html">queue</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-queue.html#.apublish">apublish</a></li><li data-type='method' style='display: none;'><a href="module-queue.html#.asubmit">asubmit</a></li><li data-type='method' style='display: none;'><a href="module-queue.html#.checkConfig">checkConfig</a></li><li data-type='method' style='display: none;'><a href="module-queue.html#.createClient">createClient</a></li><li data-type='method' style='display: none;'><a href="module-queue.html#.drop">drop</a></li><li data-type='method' style='display: none;'><a href="module-queue.html#.getClient">getClient</a></li><li data-type='method' style='display: none;'><a href="module-queue.html#.initClients">initClients</a></li><li data-type='method' style='display: none;'><a href="module-queue.html#.listen">listen</a></li><li data-type='method' style='display: none;'><a href="module-queue.html#.monitor">monitor</a></li><li data-type='method' style='display: none;'><a href="module-queue.html#.publish">publish</a></li><li data-type='method' style='display: none;'><a href="module-queue.html#.shutdown">shutdown</a></li><li data-type='method' style='display: none;'><a href="module-queue.html#.stats">stats</a></li><li data-type='method' style='display: none;'><a href="module-queue.html#.submit">submit</a></li><li data-type='method' style='display: none;'><a href="module-queue.html#.subscribe">subscribe</a></li><li data-type='method' style='display: none;'><a href="module-queue.html#.unlisten">unlisten</a></li><li data-type='method' style='display: none;'><a href="module-queue.html#.unsubscribe">unsubscribe</a></li></ul></li><li><a href="module-sendmail.html">sendmail</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-sendmail.html#.send">send</a></li></ul></li><li><a href="module-shell.html">shell</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-shell.html#.runFile">runFile</a></li><li data-type='method' style='display: none;'><a href="module-shell.html#.sendRequest">sendRequest</a></li><li data-type='method' style='display: none;'><a href="module-shell.html#.stats">stats</a></li></ul></li><li><a href="module-sql.html">sql</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-sql.html#.column">column</a></li><li data-type='method' style='display: none;'><a href="module-sql.html#.create">create</a></li><li data-type='method' style='display: none;'><a href="module-sql.html#.delete">delete</a></li><li data-type='method' style='display: none;'><a href="module-sql.html#.drop">drop</a></li><li data-type='method' style='display: none;'><a href="module-sql.html#.expr">expr</a></li><li data-type='method' style='display: none;'><a href="module-sql.html#.get">get</a></li><li data-type='method' style='display: none;'><a href="module-sql.html#.insert">insert</a></li><li data-type='method' style='display: none;'><a href="module-sql.html#.limit">limit</a></li><li data-type='method' style='display: none;'><a href="module-sql.html#.quote">quote</a></li><li data-type='method' style='display: none;'><a href="module-sql.html#.select">select</a></li><li data-type='method' style='display: none;'><a href="module-sql.html#.time">time</a></li><li data-type='method' style='display: none;'><a href="module-sql.html#.update">update</a></li><li data-type='method' style='display: none;'><a href="module-sql.html#.updateExpr">updateExpr</a></li><li data-type='method' style='display: none;'><a href="module-sql.html#.upgrade">upgrade</a></li><li data-type='method' style='display: none;'><a href="module-sql.html#.value">value</a></li><li data-type='method' style='display: none;'><a href="module-sql.html#.valueIn">valueIn</a></li><li data-type='method' style='display: none;'><a href="module-sql.html#.where">where</a></li><li data-type='method' style='display: none;'><a href="module-sql.html#.where">where</a></li></ul></li><li><a href="module-stats.html">stats</a></li><li><a href="module-watcher.html">watcher</a></li></ul><h3>Classes</h3><ul><li><a href="Counter.html">Counter</a></li><li><a href="DbPool.html">DbPool</a><ul class='methods'><li data-type='method' style='display: none;'><a href="DbPool.html#aquery">aquery</a></li><li data-type='method' style='display: none;'><a href="DbPool.html#cacheColumns">cacheColumns</a></li><li data-type='method' style='display: none;'><a href="DbPool.html#cacheIndexes">cacheIndexes</a></li><li data-type='method' style='display: none;'><a href="DbPool.html#closeDb">closeDb</a></li><li data-type='method' style='display: none;'><a href="DbPool.html#configure">configure</a></li><li data-type='method' style='display: none;'><a href="DbPool.html#convertError">convertError</a></li><li data-type='method' style='display: none;'><a href="DbPool.html#exists">exists</a></li><li data-type='method' style='display: none;'><a href="DbPool.html#nextToken">nextToken</a></li><li data-type='method' style='display: none;'><a href="DbPool.html#openDb">openDb</a></li><li data-type='method' style='display: none;'><a href="DbPool.html#prepare">prepare</a></li><li data-type='method' style='display: none;'><a href="DbPool.html#prepareOptions">prepareOptions</a></li><li data-type='method' style='display: none;'><a href="DbPool.html#prepareQuery">prepareQuery</a></li><li data-type='method' style='display: none;'><a href="DbPool.html#query">query</a></li><li data-type='method' style='display: none;'><a href="DbPool.html#shutdown">shutdown</a></li></ul></li><li><a href="DbRequest.html">DbRequest</a><ul class='methods'><li data-type='method' style='display: none;'><a href="DbRequest.html#column">column</a></li></ul></li><li><a href="DynamoDBPool.html">DynamoDBPool</a></li><li><a href="ElasticsearchPool.html">ElasticsearchPool</a></li><li><a href="FakeTrace.html">FakeTrace</a></li><li><a href="FetchOptions.html">FetchOptions</a><ul class='methods'><li data-type='method' style='display: none;'><a href="FetchOptions.html#parseCookies">parseCookies</a></li><li data-type='method' style='display: none;'><a href="FetchOptions.html#toJSON">toJSON</a></li></ul></li><li><a href="Histogram.html">Histogram</a></li><li><a href="LRUCache.html">LRUCache</a><ul class='methods'><li data-type='method' style='display: none;'><a href="LRUCache.html#.clean">clean</a></li><li data-type='method' style='display: none;'><a href="LRUCache.html#.del">del</a></li><li data-type='method' style='display: none;'><a href="LRUCache.html#.get">get</a></li><li data-type='method' style='display: none;'><a href="LRUCache.html#.put">put</a></li></ul></li><li><a href="Meter.html">Meter</a></li><li><a href="Pool.html">Pool</a></li><li><a href="SqlPool.html">SqlPool</a><ul class='methods'><li data-type='method' style='display: none;'><a href="SqlPool.html#nextToken">nextToken</a></li><li data-type='method' style='display: none;'><a href="SqlPool.html#prepare">prepare</a></li><li data-type='method' style='display: none;'><a href="SqlPool.html#prepareUpdateExpr">prepareUpdateExpr</a></li><li data-type='method' style='display: none;'><a href="SqlPool.html#prepareUpsertExpr">prepareUpsertExpr</a></li><li data-type='method' style='display: none;'><a href="SqlPool.html#query">query</a></li></ul></li><li><a href="Timer.html">Timer</a></li><li><a href="TokenBucket.html">TokenBucket</a><ul class='methods'><li data-type='method' style='display: none;'><a href="TokenBucket.html#.configure">configure</a></li><li data-type='method' style='display: none;'><a href="TokenBucket.html#.consume">consume</a></li><li data-type='method' style='display: none;'><a href="TokenBucket.html#.equal">equal</a></li><li data-type='method' style='display: none;'><a href="TokenBucket.html#.toArray">toArray</a></li><li data-type='method' style='display: none;'><a href="TokenBucket.html#.toJSON">toJSON</a></li><li data-type='method' style='display: none;'><a href="TokenBucket.html#.toString">toString</a></li></ul></li><li><a href="Trace.html">Trace</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Trace.html#.destroy">destroy</a></li><li data-type='method' style='display: none;'><a href="Trace.html#.send">send</a></li><li data-type='method' style='display: none;'><a href="Trace.html#.start">start</a></li><li data-type='method' style='display: none;'><a href="Trace.html#.stop">stop</a></li><li data-type='method' style='display: none;'><a href="Trace.html#.toString">toString</a></li></ul></li><li><a href="module-cache.CacheClient.html">CacheClient</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-cache.CacheClient.html#applyOptions">applyOptions</a></li><li data-type='method' style='display: none;'><a href="module-cache.CacheClient.html#applyReservedOptions">applyReservedOptions</a></li><li data-type='method' style='display: none;'><a href="module-cache.CacheClient.html#clear">clear</a></li><li data-type='method' style='display: none;'><a href="module-cache.CacheClient.html#close">close</a></li><li data-type='method' style='display: none;'><a href="module-cache.CacheClient.html#del">del</a></li><li data-type='method' style='display: none;'><a href="module-cache.CacheClient.html#get">get</a></li><li data-type='method' style='display: none;'><a href="module-cache.CacheClient.html#incr">incr</a></li><li data-type='method' style='display: none;'><a href="module-cache.CacheClient.html#limiter">limiter</a></li><li data-type='method' style='display: none;'><a href="module-cache.CacheClient.html#lock">lock</a></li><li data-type='method' style='display: none;'><a href="module-cache.CacheClient.html#put">put</a></li><li data-type='method' style='display: none;'><a href="module-cache.CacheClient.html#stats">stats</a></li><li data-type='method' style='display: none;'><a href="module-cache.CacheClient.html#unlock">unlock</a></li></ul></li><li><a href="module-cache.LocalClient.html">LocalClient</a></li><li><a href="module-cache.RedisClient.html">RedisClient</a></li><li><a href="module-cache.WorkerClient.html">WorkerClient</a></li><li><a href="module-push.APNClient.html">APNClient</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-push.APNClient.html#send">send</a></li></ul></li><li><a href="module-push.FCMClient.html">FCMClient</a></li><li><a href="module-push.SNSClient.html">SNSClient</a></li><li><a href="module-push.WebpushClient.html">WebpushClient</a></li><li><a href="module-queue.DBClient.html">DBClient</a></li><li><a href="module-queue.EventBridgeClient.html">EventBridgeClient</a></li><li><a href="module-queue.JSONClient.html">JSONClient</a></li><li><a href="module-queue.LocalClient.html">LocalClient</a></li><li><a href="module-queue.NatsClient.html">NatsClient</a></li><li><a href="module-queue.QueueClient.html">QueueClient</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-queue.QueueClient.html#channel">channel</a></li><li data-type='method' style='display: none;'><a href="module-queue.QueueClient.html#monitor">monitor</a></li><li data-type='method' style='display: none;'><a href="module-queue.QueueClient.html#schedule">schedule</a></li></ul></li><li><a href="module-queue.RedisClient.html">RedisClient</a></li><li><a href="module-queue.SNSClient.html">SNSClient</a></li><li><a href="module-queue.SQSClient.html">SQSClient</a></li><li><a href="module-queue.WorkerClient.html">WorkerClient</a></li></ul><h3>Global</h3><ul><li><a href="global.html#ConfigOptions">ConfigOptions</a></li><li><a href="global.html#DbConfigOptions">DbConfigOptions</a></li><li><a href="global.html#DbRequestColumn">DbRequestColumn</a></li><li><a href="global.html#DbRequestOptions">DbRequestOptions</a></li><li><a href="global.html#DbResultCallback">DbResultCallback</a></li><li><a href="global.html#DbTable">DbTable</a></li><li><a href="global.html#DbTableColumn">DbTableColumn</a></li><li><a href="global.html#DbUser">DbUser</a></li><li><a href="global.html#SESTransport">SESTransport</a></li><li><a href="global.html#SendGridTransport">SendGridTransport</a></li><li><a href="global.html#queryPrepare">queryPrepare</a></li></ul>
    
</nav>

<div id="main">
    
    <h1 class="page-title">cache.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/*
 *  Author: Vlad Seryakov vseryakov@gmail.com
 *  backendjs 2018
 */

const logger = require(__dirname + '/logger');
const lib = require(__dirname + '/lib');
const metrics = require(__dirname + '/metrics');
const Client = require(__dirname + "/cache/client");

/**
 * @module cache
 */

const cache = {
    name: "cache",

    /**
     * @var {ConfigOptions[]} args
     */
    args: [
        { name: "config", obj: "_config", type: "json", merge: 1, onupdate: "checkConfig", descr: 'An object with driver configs, an object with at least url or an url string', example: '-cache-config {"redis":{"url":redis://localhost","count":1},"nats":"nats://localhost:4222"}' },
        { name: "([a-z0-9]+)-options$", obj: "_config.$1", type: "map", merge: 1, onupdate: "applyOptions", descr: "Additional parameters for clients, specific to each implementation", example: "-cache-redis-options count:10,interval:100" },
        { name: "([a-z0-9]+)-options-(.+)", obj: "_config.$1", make: "$2", camel: '-', autotype: 1, onupdate: "applyOptions", descr: "Additional parameters for clients, specific to each implementation", example: "-cache-default-options-count 10" },
        { name: "([a-z0-9]+)", obj: "_config.$1", make: "url", nocamel: 1, onupdate: "applyOptions", descr: "An URL that points to a cache server in the format PROTO://HOST[:PORT]?PARAMS, multiple clients can be defined with unique names, all params starting with bk- will be copied into the options without the prefix and removed from the url, the rest of params will be left in the url", example: "-cache-redis redis://localhost?bk-count=3&amp;bk-ttl=3000" },
    ],

    _nameIndex: 0,

    /** @var {object} - queue modules by type */
    modules: {},

    /** @var {object} - queue live clients by name */
    clients: { default: new Client() },

    tokenBucket: new metrics.TokenBucket(),
    lru: new lib.LRUCache(),

    // Config params
    _config: {
        local: "local://",
        worker: "worker://",
    },
};

/**
 * Cache module for shared cache and subscriptions.
 *
 * Some drivers (Redis) may support TTL so global options.ttl or local options.ttl can be used
 * for put/incr operations and it will be honored if it is suported.
 *
 * For caches that support maps, like Redis the *8options.mapName** can be used with get/put/incr/del to
 * work with maps and individual keys inside maps.
 *
 * All methods use **options.cacheName** for non-default cache.
 * If it is an array then a client will be picked sequentially by maintaining internal sequence number.
 *
 * Empty default client always exists, it can be overridden to make default some other driver
 *
 * To enable stats collection for a cache it must be enabled with config: cache-redis-options-metrics=1
 *
 * The class {@link module:cache.CacheClient} defines the methods that a driver may or may not implement.
 *
 * The url query parameters that start with **bk-** will be extracted from the url and placed in the class **options* object,
 * this is a way to pass special properties without using **cache-options**, the rest of the url parameters will be passed to the driver.
 *
 * @example
 * cache-default=redis://
 * cache-redis=redis://?bk-enable_offline_queue=1
 * cache-config={ "limiter": "local://", "redis": "redis://" }
 */

module.exports = cache;

cache.applyOptions = function(val, options)
{
    if (!options.obj) return;
    logger.debug("applyOptions:", options.obj, options.name, "NEW:", options.context);
    var d = lib.split(options.obj, ".");
    var client = d[0] == "_config" &amp;&amp; this.getClient(d[1]);
    if (client?.cacheName != (d[1] || "default")) return;
    logger.debug("applyOptions:", client.cacheName, options.obj, options.name, "OLD:", client.options);
    if (options.name == "url" &amp;&amp; typeof val == "string") client.url = val;
    client.applyOptions(options.context);
}

/**
 * Reinitialize a client for cache purposes, previous client will be closed.
 * @memberof module:cache
 * @method initClients
 */
cache.initClients = function()
{
    for (const name in this._config) {
        if (!name) continue;
        var opts = this._config[name];
        if (typeof opts == "string") opts = { url: opts };
        var client = this.createClient(opts);
        if (!client) continue;

        try {
            if (this.clients[name]) this.clients[name].close();
        } catch (e) {
            logger.error("initClient:", cache.name, name, e.stack);
        }
        client.cacheName = name;
        this.clients[name] = client;
    }
}

/**
 * Initialize missing or new clients, existing clients stay the same
 * @memberof module:cache
 * @method checkConfig
 */
cache.checkConfig = function()
{
    for (const name in this._config) {
        if (!name) continue;
        if (this.clients[name]) continue;

        var opts = this._config[name];
        if (typeof opts == "string") opts = { url: opts };
        var client = this.createClient(opts);
        if (!client) continue;

        client.cacheName = name;
        this.clients[name] = client;
        logger.debug("checkConfig:", cache.name, name, client.name, "added");
    }
}

/**
 * Close all existing clients except empty local client
 * @memberof module:cache
 * @method shutdown
 */
cache.shutdown = function(options, callback)
{
    for (const name in this.clients) {
        this.clients[name].close();
        delete this.clients[name];
    }
    this.clients.default = new Client();
    lib.tryCall(callback);
}

/**
 * Return a new client for the given host or null if not supported
 * @memberof module:cache
 * @method createClient
 */
cache.createClient = function(options)
{
    var client = null;
    try {
        var type = lib.split(options?.url, ":")[0];
        if (!type) return;

        var Mod = this.modules[type];
        if (!Mod) {
            Mod = this.modules[type] = require(__dirname + "/cache/" + type);
        }
        if (!Mod) return;
        client = new Mod(options);
        client.applyReservedOptions(options);
    } catch (e) {
        logger.error("createClient:", cache.name, options, e.stack);
    }
    return client;
}

/**
 * Return a cache client by name if specified in the options or use default client which always exists,
 * use cacheName to specify a specific driver.
 * If it is an array it will rotate items sequentially.
 * @param {object} [options]
 * @returns {module:cache.CacheClient}
 * @memberof module:cache
 * @method getClient
 */
cache.getClient = cache.getCache = function(options)
{
    var client, name = Array.isArray(options) || typeof options == "string" ? options : options?.cacheName;
    if (name) {
        if (Array.isArray(name)) {
            if (name.length > 1) {
                name = name[this._nameIndex++ % name.length];
                if (this._nameIndex >= Number.MAX_SAFE_INTEGER) this._nameIndex = 0;
            } else {
                name = name[0];
            }
        }
        client = this.clients[name];
    }
    return client || this.clients.default;
}

/**
 * Returns the cache statistics, the format depends on the cache type used
 * @param {object} [options]
 * @param {function} [callback]
 * @memberof module:cache
 * @method stats
 */
cache.stats = function(options, callback)
{
    if (typeof options == "function") callback = options, options = null;
    logger.dev("cache.stats:", options);
    try {
        this.getClient(options).stats(options || {}, typeof callback == "function" ? callback : undefined);
    } catch (e) {
        logger.error('cache.stats:', e.stack);
        if (typeof callback == "function") callback(e);
    }
}

/**
 * Async version of {@link module:cache.stats}
 * @param {object} [options]
 * @example
 * const { err, data } = await cache.astats();
 * @memberOf module:cache
 * @method astats
 * @async
 */
cache.astats = function(options)
{
    return new Promise((resolve, reject) => {
        cache.stats(options, (err, data) => {
            resolve({ err, data });
        });
    });
}

/**
 * Clear all or only items that match the given pattern
 * @param {string} pattern
 * @param {object} [options]
 * @param {function} [callback]
 * @memberof module:cache
 * @method clear
 */
cache.clear = function(pattern, options, callback)
{
    if (typeof options == "function") callback = options, options = null;
    logger.dev("cache.clear:", pattern, options);
    try {
        this.getClient(options).clear(typeof pattern == "string" &amp;&amp; pattern, typeof callback == "function" ? callback : undefined);
    } catch (e) {
        logger.error('cache.clear:', pattern, e.stack);
        if (typeof callback == "function") callback(e);
    }
}

/**
 * Async version of {@link module:cache.stats}
 * @param {string} pattern
 * @param {object} [options]
 * @example
 * const { err, data } = await cache.aclear("key:*");
 * @memberOf module:cache
 * @method aclear
 * @async
 */
cache.aclear = function(pattern, options)
{
    return new Promise((resolve, reject) => {
        cache.clear(pattern, options, (err, data) => {
            resolve({ err, data });
        });
    });
}


/**
 * Retrieve an item from the cache by key.
 * @param {string|string[]} key
 * If the key is an array then it returns an array with values for each key, for non existent keys an empty
 * string will be returned. For maps only if the key is * it will return the whole object, otherwise only value(s)
 * are returned.
 * @param {object} [options]
 * @param {boolean} [options.del] is given then it will delete the key after returning, i.e. Redis GETDEL op
 * @param {any} [options.set] if given and no value exists in the cache it will be set as the initial value, still
 *  nothing will be returned to signify that a new value assigned.
 * @param {string} [options.mapName] defines a map from which the key will be retrieved if the cache supports maps, to get the whole map
 *  the key must be set to *
 * @param {string} [options.listName] defines a map from which to get items, if a key is given it will return 1 if it belongs to the list,
 *  if no key is provided it will return an array with 2 elements:  [a random key, the length of the list], to get the whole list specify * as the key. Specifying
 *  del in the options will delete returned items from the list.
 * @param {int} [options.ttl] can be used with lists with del and empty key, in such case all popped up keys will be saved in
 *   the cache with specified time to live, when being popped up every key is checked if it has been served already, i.e.
 *   it exists in the cache and not expired yet, such keys are ignored and only never seen keys are returned
 * @param {string} [options.datatype] specifies that the returned value must be converted into the specified type using lib.toValue
 * @param {function} callback
 *
 * @example
 * cache.get(["my:key1", "my:key2"], function(err, data) { console.log(data) });
 * cache.get("my:key", function(err, data) { console.log(data) });
 * cache.get("my:counter", { set: 10 }, function(err, data) { console.log(data) });
 * cache.get("*", { mapName: "my:map" }, function(err, data) { console.log(data) });
 * cache.get("key1", { mapName: "my:map" }, function(err, data) { console.log(data) });
 * cache.get(["key1", "key2"], { mapName: "my:map" }, function(err, data) { console.log(data) });
 * cache.get(["key1", "key2"], { listName: "my:list" }, function(err, data) { console.log(data) });
 * cache.get("", { listName: "my:list", del: 1 }, function(err, data) { console.log(data) });
 * cache.get("", { listName: "my:list", del: 1, ttl: 30000 }, function(err, data) { console.log(data) });
 * @memberof module:cache
 * @method get
 */
cache.get = function(key, options, callback)
{
    if (typeof options == "function") callback = options, options = null;
    logger.dev("cache.get:", key, options);
    try {
        const client = this.getClient(options);
        const _timer = client.metrics.start();
        client.get(key, options || {}, (err, val) => {
            if (!err &amp;&amp; options?.datatype) {
                val = Array.isArray(val) ? val = val.map((x) => (lib.toValue(x, options.datatype))) : lib.toValue(val, options.datatype);
            }
            _timer.end();
            if (typeof callback == "function") callback(err, val);
        });
    } catch (e) {
        logger.error('cache.get:', key, e.stack);
        if (typeof callback == "function") callback(e);
    }
}

/**
 * Async version of {@link module:cache.get}
 * @param {string|string[]} key
 * @param {object} [options]
 * @example
 * const { err, data } = await cache.aget("key");
 * @memberOf module:cache
 * @method aget
 * @async
 */
cache.aget = function(key, options)
{
    return new Promise((resolve, reject) => {
        cache.get(key, options, (err, data) => {
            resolve({ err, data });
        });
    });
}


/**
 * Delete an item by key(s),  if key is an array all keys will be deleted at once atomically if supported
 * @param {string} key
 * @param {object} [options]
 * @param {string} [options.mapName] defines a map from which the counter will be deleted if the cache supports maps, to delete the whole map
 *  the key must be set to *
 * @param {string} [options.listName] defines a list from which an item should be removed
 * @param {function} [callback]
 * @example
 * cache.del("my:key")
 * cache.del("key1", { mapName: "my:map" })
 * cache.del("*", { mapName: "my:map" })
 * cache.del("1", { listName: "my:list" })
 * @memberof module:cache
 * @method del
 */
cache.del = function(key, options, callback)
{
    if (typeof options == "function") callback = options, options = null;
    logger.dev("cache.del:", key, options);
    try {
        this.getClient(options).del(key, options || {}, typeof callback == "function" ? callback : undefined);
    } catch (e) {
        logger.error('cache.del:', key, e.stack);
        if (typeof callback == "function") callback(e);
    }
}

/**
 * Async version of {@link module:cache.del}
 * @param {string} key
 * @param {object} [options]
 * @example
 * const { err, data } = await cache.adel("key");
 * @memberOf module:cache
 * @method adel
 * @async
 */
cache.adel = function(key, options)
{
    return new Promise((resolve, reject) => {
        cache.del(key, options, (err, data) => {
            resolve({ err, data });
        });
    });
}


/**
 * Replace or put a new item in the cache.
 * @param {string} key
 * @param {string|object} val
 * @param {object} [options]
 * @param {int} [options.ttl] can be passed in milliseconds if the driver supports it
 * @param {string} [options.mapName] defines a map where the counter will be stored if the cache supports maps, to store the whole map in one
 *    operation the key must be empty or * and the val must be an object
 * @param {boolean} [options.setmax] if not empty tell the driver to set this new number only if there is no existing
 *    value or it is less that the new number, only works for numeric values
 * @param {string} [options.listName] defines a list where to add items, val can be a value or an array of values, key is ignored in this case.
 *    Returns an array with 2 items: [added, total] where added is how many iterms just added and the total number of items in the list after the operation.
 * @param {function} [callback]
 * @example
 * cache.put("my:key", 2)
 * cache.put("my:key", 1, { setmax: 1 })
 * cache.put("key1", 1, { mapName: "my:map" })
 * cache.put("*", { key1: 1, key2: 2 }, { mapName: "my:map" })
 * cache.put("", [1,2,3], { listName: "my:list" }, (err, rc) => { })
 * @memberof module:cache
 * @method put
 */
cache.put = function(key, val, options, callback)
{
    if (typeof options == "function") callback = options, options = null;
    logger.dev("cache.put:", key, val, options);
    try {
        const client = this.getClient(options);
        const _timer = client.metrics.start();
        client.put(key, val, options || {}, (err, val) => {
            _timer.end();
            if (typeof callback == "function") callback(err, val);
        });
    } catch (e) {
        logger.error('cache.put:', key, e.stack);
        if (typeof callback == "function") callback(e);
    }
}

/**
 * Async version of {@link module:cache.put}
 * @param {string} key
 * @param {string|object} val
 * @param {object} [options]
 * @example
 * const { err, data } = await cache.aput("key", { ... });
 * @memberOf module:cache
 * @method aput
 * @async
 */
cache.aput = function(key, val, options)
{
    return new Promise((resolve, reject) => {
        cache.put(key, val, options, (err, data) => {
            resolve({ err, data });
        });
    });
}


/**
 * Increase/decrease a counter in the cache by val, non existent items are treated as 0, if a callback is given an
 * error and the new value will be returned.
 * @param {string|string[]} key
 * - if key is an array then increment each item in the list with given val number,
 *     in this case ttl can be an array as well with specific ttl per key
 * @param {int|object} val
 * - if val is an object then all numeric properties will be incremented, other properties just set.
 * - if val is an object then either mapName or non empty key is used for map
 * - if val is an object and the key is empty then all properties are treated as standalone items
 * @param {object} [options]
 * @param {int} [options.ttl] in milliseconds can be used if the driver supports it
 * @param {string} [options.mapName] defines a map where the counter will be stored if the cache supports maps
 * @param {string} [options.returning] - return old or new map object, if new or * it will be the first item in the result array, if old the last,
 *    to return all values for multi updates it must be provided, otherwise only first result by default.
 * @param {function} [callback]
 * @example
 * cache.incr("my:key", 1)
 * cache.incr("counter", 1, { mapName: "my:map" })
 * cache.incr("my:map", { count: 1, name: "aaa", mtime: Date.now().toString() })
 * cache.incr("", { count: 1, name: "bbb", mtime: Date.now().toString() }, { mapName: "my:map" })
 * cache.incr("", { "my-key": 1, counter2: 2 })
 * cache.incr([ "my:key", "my:counter"], 1 }, { ttl: [1000, 30000] })
 * @memberof module:cache
 * @method incr
 */
cache.incr = function(key, val, options, callback)
{
    if (typeof options == "function") callback = options, options = null;
    logger.dev("cache.incr:", key, val, options);
    try {
        const client = this.getClient(options);
        const _timer = client.metrics.start();
        client.incr(key, val, options || {}, (err, val) => {
            _timer.end();
            if (typeof callback == "function") {
                callback(err, options?.returning ? val || "": lib.toNumber(Array.isArray(val) ? val[0] : val));
            }
        });
    } catch (e) {
        logger.error('cache.incr:', key, e.stack);
        if (typeof callback == "function") callback(e);
    }
}

/**
 * Async version of {@link module:cache.incr}
 * @param {string} key
 * @param {number} val
 * @param {object} [options]
 * @example
 * const { err, data } = await cache.aincr("key", 10);
 * @memberOf module:cache
 * @method aincr
 * @async
 */
cache.aincr = function(key, val, options)
{
    return new Promise((resolve, reject) => {
        cache.incr(key, val, options, (err, data) => {
            resolve({ err, data });
        });
    });
}


/**
 * Check for rate limit using the default or specific cache, by default TokenBucket using local LRU cache is
 * used unless a client provides its own implementation.
 *
 * @param {object} options
 * @param {string} options.name - unique id, can be IP address, account id, etc...
 * @param {int} [options.max - the maximum burst capacity
 * @param {int} options.rate - the rate to refill tokens
 * @param {int} [options.interval - interval for the bucket refills, default 1000 ms
 * @param {int} [options.ttl] - auto expire after specified ms since last use
 * @param {boolean} [options.reset] - if true reset the token bucket if not consumed or the total reached this value if it is a number greater than 1
 * @param {int} [options.multiplier] - multiply the interval after it consumed all tokens, subsequent checks use the increased interval, fractions supported,
 *    if the multiplier is positive then the interval will keep increasing indefinitely, if it is negative the interval will reset to the default
 *    value on first successful consumption
 *
 * @param {function} callback - takes 2 arguments:
 * - delay is a number of milliseconds till the bucket can be used again if not consumed, i.e. 0 means consumed.
 * - info is an object with info about the state of the token bucket after the operation with properties: delay, count, total, elapsed
 * @memberof module:cache
 * @method limiter
 */
cache.limiter = function(options, callback)
{
    logger.dev("limiter:", options);
    if (typeof callback != "function") return;
    if (!options?.name) return callback(0, {});
    options.rate = lib.toNumber(options.rate, { min: 0 });
    if (!options.rate) return callback(0, {});
    options.max = lib.toNumber(options.max, { min: options.rate, max: options.max || options.rate });
    options.interval = lib.toNumber(options.interval, { min: 0, zero: 1000 });
    options.ttl = lib.toNumber(options.ttl, { min: 0 });
    options.reset = lib.toNumber(options.reset);
    options.multiplier = lib.toNumber(options.multiplier);
    try {
        this.getClient(options).limiter(options, callback);
    } catch (e) {
        logger.error('cache.limiter:', e.stack);
        callback(options.interval, {});
    }
}

cache.alimiter = async function(options)
{
    return new Promise((resolve, reject) => {
        cache.limiter(options, (delay, info) => {
            resolve({ delay, info });
        });
    });
}

/**
 * Keep checking the limiter until it is clear to proceed with the operation, if there is no available tokens in the bucket
 * it will wait and try again until the bucket is filled.
 *
 * The callback will receive the same arguments as {@link module:cache.limiter}.
 *  options._retries will be set to how many times it tried.
 * @param {object} options - same as in {@link module:cache.limiter}
 * @param {int} [options.retry] - To never retry pass -1 or number of loops to run before exiting
 * @memberof module:cache
 * @method checkLimiter
 */
cache.checkLimiter = function(options, callback)
{
    options._retries = lib.toNumber(options._retries) + 1;
    this.limiter(options, (delay, info) => {
        logger.debug("checkLimiter:", delay, options, info);
        if (!delay || (options.retry &amp;&amp; options._retries >= options.retry)) {
            return callback(delay, info);
        }
        setTimeout(this.checkLimiter.bind(this, options, callback), delay);
    });
}

cache.acheckLimiter = async function(options)
{
    return new Promise((resolve, reject) => {
        cache.checkLimiter(options, (delay, info) => {
            resolve({ delay, info });
        });
    });
}

/**
 * Uses local limiter returns the same message with consumed set to 1 or 0
 * @param {object} msg
 * @param {string} msg.name
 * @returns {object}
 * @memberof module:cache
 * @method localLimiter
 */
cache.localLimiter = function(msg)
{
    var interval = msg.interval;
    var token = this.lru.get(msg.name);
    this.tokenBucket.configure(token || msg);
    if (msg.multiplier &amp;&amp; token) msg.interval = this.tokenBucket._interval;
    // Reset the bucket if any number has been changed, now we have a new rate to check
    if (!this.tokenBucket.equal(msg.rate, msg.max, msg.interval)) this.tokenBucket.configure(msg);
    msg.consumed = this.tokenBucket.consume(msg.consume || 1);
    msg.delay = msg.consumed ? 0 : this.tokenBucket.delay(msg.consume || 1);
    msg.total = this.tokenBucket._total;
    msg.count = this.tokenBucket._count;
    msg.elapsed = this.tokenBucket._elapsed;
    if ((msg.delay &amp;&amp; msg.reset) || (msg.reset > 1 &amp;&amp; msg.total >= msg.reset)) {
        this.lru.del(msg.name);
    } else {
        if (msg.multiplier) {
            if (msg.delay) {
                this.tokenBucket._interval = Math.min(30000000000, this.tokenBucket._interval * Math.abs(msg.multiplier));
                msg.interval = this.tokenBucket._interval;
            } else
            if (msg.multiplier &lt; 0) {
                this.tokenBucket._interval = msg.interval = interval;
            }
        }
        token = this.tokenBucket.toArray();
        this.lru.put(msg.name, token, msg.expire);
    }
    logger.debug("cache:limiter:", msg, token);
    return msg;
}

/**
 * Implementation of a lock with optional ttl, only one instance can lock it, can be for some period of time and will expire after timeout.
 *
 * This is intended to be used for background job processing or something similar when
 * only one instance is needed to run. At the end of the processing {@link module.cache.unlock}
 * must be called to enable another instance immediately, otherwise it will be available after the ttl only.
 *
 * The callback must be passed which will take an error and a boolean value, if true is returned it means the timer has been locked by the caller,
 * otherwise it is already locked by other instance. In case of an error the lock is not supposed to be locked by the caller.
 * @param {string} name - unique lock name
 * @param {object} [options]
 * @param {int} [options.ttl] - ttl period in milliseconds.
 * @param {int} [options.timeout] - if given the function will keep trying to lock for the timeout milliseconds.
 * @param {boolean} [options.set] - if given it will unconditionally set the lock for the specified ttl, this is for cases when
 * the lock must be active for longer because of the long running task
 * @param {function} [callback]
 * @example
 * cache.lock("my-lock", { ttl: 60000, timeout: 30000 }, (err, locked) => {
 *   if (locked) {
 *       ...
 *       cache.unlock("my-lock");
 *   }
 * });
 * @memberof module:cache
 * @method lock
 */
cache.lock = function(name, options, callback)
{
    if (typeof options == "function") callback = options, options = null;
    logger.dev("cache.lock:", name, options);
    var self = this, locked = false, delay = 0, timeout = 0;
    var started = Date.now();
    options = options || {};
    lib.doWhilst(
        function(next) {
            try {
                self.getClient(options).lock(name, options, (err, val) => {
                    if (err) return next(err);
                    locked = lib.toBool(val);
                    setTimeout(next, delay);
                });
            } catch (e) {
                next(e);
            }
        },
        function() {
            if (!delay) delay = lib.toNumber(options.delay);
            if (!timeout) timeout = lib.toNumber(options.timeout);
            return !locked &amp;&amp; timeout > 0 &amp;&amp; Date.now() - started &lt; timeout;
        },
        function(err) {
            if (err) logger.error('cache.lock:', err.stack);
            if (typeof callback == "function") callback(err, locked);
    }, true);
}

/**
 * Async version of {@link module:cache.lock}
 * @param {string} name
 * @param {object} [options]
 * @example
 * const { err, locked } = await cache.alock("key", { ttl: 1000 });
 * @memberOf module:cache
 * @method alock
 * @async
 */
cache.alock = function(name, options)
{
    return new Promise((resolve, reject) => {
        cache.lock(name, options, (err, locked) => {
            resolve({ err, locked });
        });
    });
}


/**
 * Unconditionally unlock the lock by key, any client can unlock any lock.
 * @param {string} name
 * @param {object} [options]
 * @param {function} [callback]
 * @memberof module:cache
 * @method unlock
 */
cache.unlock = function(name, options, callback)
{
    logger.dev("cache.unlock:", name, options);
    try {
        this.getClient(options).unlock(name, options || {}, typeof callback == "function" ? callback : undefined);
    } catch (e) {
        logger.error('cache.unlock:', e.stack);
        if (typeof callback == "function") callback(e);
    }
}

/**
 * Async version of {@link module:cache.unlock}
 * @param {string} name
 * @param {object} [options]
 * @example
 * const { err, data } = await cache.aunlock("key");
 * @memberOf module:cache
 * @method aunlock
 * @async
 */
cache.aunlock = function(name, options)
{
    return new Promise((resolve, reject) => {
        cache.unlock(name, options, (err, data) => {
            resolve({ err, data });
        });
    });
}


cache.configureCollectStats = function(options)
{
    for (let q in this.clients) {
        const cl = this.clients[q];
        if (!cl.options?.metrics) continue;
        const m = cl.metrics.toJSON({ reset: 1 });
        q = cl.cacheName;
        if (m.meter?.count) {
            options.stats["cache_" + q + "_req_count"] = m.meter.count;
            options.stats["cache_" + q + "_req_rate"] = m.meter.rate;
            options.stats["cache_" + q + "_res_time"] = m.histogram.med;
        }
    }
}
</code></pre>
        </article>
    </section>




    
    
</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 4.0.5</a> using the <a href="https://github.com/vseryakov/docdash">docdash</a> theme.
</footer>


<script src="scripts/search.js" defer></script>



<script src="scripts/collapse.js" defer></script>



</body>
</html>
